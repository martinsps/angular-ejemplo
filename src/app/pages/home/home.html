<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h3 m-0">Usuarios</h1>
    <a class="btn btn-primary" [routerLink]="['/newuser']">Nuevo usuario</a>
  </div>

  <div class="row g-3">
    <div class="col-12" *ngIf="loading()">
      <div class="alert alert-info">Cargando usuarios...</div>
    </div>
    <div class="col-12" *ngIf="error()">
      <div class="alert alert-danger">{{ error() }}</div>
    </div>

    <ng-container *ngIf="!loading() && !error()">
      <div class="col-12" *ngIf="users().length === 0">
        <div class="alert alert-warning">No hay usuarios.</div>
      </div>
      <div class="col-12 col-sm-6 col-md-4 col-lg-3" *ngFor="let user of pagedUsers()">
        <div class="card user-card h-100">
          <img
            class="card-img-top"
            [src]="user.image"
            [alt]="user.first_name + ' ' + user.last_name"
          />
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ user.first_name }} {{ user.last_name }}</h5>
            <p class="card-text text-muted mb-3">{{ user.email }}</p>
            <div class="mt-auto card-actions">
              <a class="action text-decoration-none" [routerLink]="['/user', user.id]">
                <i class="bi bi-search"></i>
                <span>Ver detalle</span>
              </a>
              <button class="action btn btn-link p-0 text-secondary" (click)="goToUpdate(user.id)">
                <i class="bi bi-arrow-repeat"></i>
                <span>Actualizar</span>
              </button>
              <button
                class="action btn btn-link p-0 text-secondary"
                (click)="confirmDelete(user.id, user.first_name)"
              >
                <i class="bi bi-trash"></i>
                <span>Borrar</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </div>

  <div class="d-flex justify-content-center align-items-center mt-3" *ngIf="totalPages() > 1">
    <div class="pagination-dots">
      <span class="dot" (click)="goToPage(page() - 1)">«</span>
      <span
        class="dot"
        *ngFor="let p of [].constructor(totalPages()); let i = index"
        [class.bg-light]="i + 1 !== page()"
        [class.fw-bold]="i + 1 === page()"
        (click)="goToPage(i + 1)"
        >{{ i + 1 }}</span
      >
      <span class="dot" (click)="goToPage(page() + 1)">»</span>
    </div>
  </div>
</div>
